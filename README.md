# ğŸŒï¸ é«˜å°”å¤«æŒ¥æ†åŠ¨ä½œ AI æ™ºèƒ½åˆ†æç³»ç»Ÿ

> åŸºäºå§¿æ€ä¼°è®¡çš„äººä½“éª¨éª¼å…³é”®ç‚¹æ£€æµ‹ã€éª¨éª¼è¿çº¿å¯è§†åŒ–ä¸æŒ¥æ†é˜¶æ®µæ™ºèƒ½åˆ†æ

## ğŸ“– é¡¹ç›®ç®€ä»‹

æœ¬é¡¹ç›®ä¸ºé«˜å°”å¤«æ¨¡æ‹Ÿå™¨å¼€å‘ä¸€å¥— **AI æ•™ç»ƒ** åŠŸèƒ½æ¨¡å—ï¼Œå®ç°ä»¥ä¸‹æ ¸å¿ƒèƒ½åŠ›ï¼š

- **äººä½“éª¨éª¼å…³é”®ç‚¹æ£€æµ‹**ï¼šè‡ªåŠ¨è¯†åˆ«çƒå‘˜èº«ä½“çš„å…³é”®å…³èŠ‚ç‚¹ï¼ˆè‚©è†€ã€æ‰‹è‚˜ã€æ‰‹è…•ã€è„ŠæŸ±ã€é«‹ã€è†ç›–ã€è„šè¸ç­‰ï¼‰
- **éª¨éª¼è¿çº¿ç»˜åˆ¶**ï¼šå°†æ£€æµ‹åˆ°çš„å…³èŠ‚ç‚¹æŒ‰äººä½“ç»“æ„æ­£ç¡®è¿æ¥ï¼Œå½¢æˆå®Œæ•´çš„éª¨éª¼å§¿æ€çº¿
- **å‡»çƒå›æ”¾è§†é¢‘å åŠ **ï¼šå°†å…³èŠ‚ç‚¹æ ‡è®°å’Œè¿çº¿å®æ—¶å åŠ åœ¨å‡»çƒå›æ”¾è§†é¢‘ä¸Š
- **æŒ¥æ†é˜¶æ®µæ£€æµ‹**ï¼šè‡ªåŠ¨è¯†åˆ« 8 ä¸ªæŒ¥æ†å…³é”®é˜¶æ®µï¼ˆå‡†å¤‡ â†’ ä¸Šæ† â†’ é¡¶æ† â†’ ä¸‹æ† â†’ å‡»çƒ â†’ é€æ† â†’ æ”¶æ†ï¼‰
- **æ•™å­¦åˆ†ææŒ‡æ ‡**ï¼šè®¡ç®—è„ŠæŸ±å€¾æ–œè§’ã€é«‹éƒ¨æ—‹è½¬è§’ã€æ‰‹è‡‚æŒ¥æ†å¹³é¢ç­‰ç”Ÿç‰©åŠ›å­¦æŒ‡æ ‡

## ğŸ¯ åº”ç”¨åœºæ™¯

å­¦å‘˜åœ¨æ¨¡æ‹Ÿå™¨ä¸­æ‰“å®Œçƒåï¼Œè§‚çœ‹å›æ”¾æ—¶ç”»é¢ä¸Šç›´æ¥æ˜¾ç¤ºï¼š
1. èº«ä½“éª¨éª¼çº¿å’ŒåŠ¨ä½œè½¨è¿¹
2. å„æŒ¥æ†é˜¶æ®µè‡ªåŠ¨æ ‡æ³¨
3. å…³é”®è§’åº¦æ•°å€¼
4. ä¸æ ‡å‡†åŠ¨ä½œçš„å¯¹æ¯”åå·®

ä¸€çœ¼å°±èƒ½çœ‹å‡ºåŠ¨ä½œå“ªé‡Œä¸æ ‡å‡†ã€‚

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

| ç»„ä»¶ | æŠ€æœ¯é€‰å‹ | è¯´æ˜ |
|------|---------|------|
| å§¿æ€ä¼°è®¡å¼•æ“ | [rtmlib](https://github.com/Tau-J/rtmlib) | è¶…è½»é‡å°è£…ï¼Œæ—  mmcv ä¾èµ–ï¼Œæ”¯æŒ RTMPose / ViTPose++ / RTMW |
| éª¨éª¼æ¨¡å‹ | RTMPose-l (17ç‚¹) / RTMW (133ç‚¹) | 17ç‚¹ç”¨äºå®æ—¶å›æ”¾ï¼Œ133ç‚¹ç”¨äºç²¾ç»†æ¡æ†åˆ†æ |
| 3D å§¿æ€ | RTMW3D | 3Då…¨èº«å…³é”®ç‚¹ä¼°è®¡ï¼Œå¯æ—‹è½¬æŸ¥çœ‹æŒ¥æ†å¹³é¢ |
| æŒ¥æ†é˜¶æ®µæ£€æµ‹ | [GolfDB](https://github.com/wmcnally/golfdb) SwingNet | 8 é˜¶æ®µè‡ªåŠ¨è¯†åˆ«ï¼ŒCVPR Workshop è®ºæ–‡ |
| äººä½“æ£€æµ‹å™¨ | YOLOX-m | ç›®æ ‡æ£€æµ‹ï¼Œå®šä½ç”»é¢ä¸­çš„çƒå‘˜ |
| è§†é¢‘å¤„ç† | OpenCV | è§†é¢‘è¯»å–ã€å¸§å¤„ç†ã€éª¨éª¼å åŠ ç»˜åˆ¶ |
| æ¨ç†åç«¯ | ONNXRuntime / TensorRT | ONNX é€šç”¨æ¨ç† / TensorRT GPU åŠ é€Ÿ |
| GUI å±•ç¤º | Gradio / PyQt | Demo æ¼”ç¤ºç•Œé¢ |

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

| æ¨¡å‹ | å…³é”®ç‚¹æ•° | ç²¾åº¦ (AP) | GPU é€Ÿåº¦ | é€‚ç”¨åœºæ™¯ |
|------|---------|----------|---------|---------|
| RTMPose-m | 17 | 75.8 | 430+ FPS | å®æ—¶å›æ”¾å åŠ  |
| RTMPose-l | 17 | 78.3 | 160+ FPS | é«˜ç²¾åº¦åˆ†æ |
| RTMW-l | 133 | 70.1 | â€” | å…¨èº«+æ‰‹æŒ‡åˆ†æ |
| ViTPose++-l | 17 | 78.6 | â€” | æœ€é«˜ç²¾åº¦ç¦»çº¿åˆ†æ |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Python >= 3.10
- NVIDIA GPUï¼ˆæ¨èï¼ŒCPU ä¹Ÿå¯è¿è¡Œï¼‰

### å®‰è£…ï¼ˆæ¨è uvï¼‰

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/gong-type/golf-swing-ai-coach.git
cd golf-swing-ai-coach

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒå¹¶å®‰è£…ä¾èµ–
uv venv
uv sync
```

é»˜è®¤ä¾èµ–å·²åŒ…å« `onnxruntime-gpu`ã€‚

### Windows æ‘„åƒå¤´å®æ—¶ Demo

```bash
# æ¨èï¼ˆè‡ªåŠ¨é€‰è®¾å¤‡/æ¨¡å¼ï¼Œé€‚åˆå¤§å¤šæ•°æœºå™¨ï¼‰
uv run python demo_webcam.py --camera 0 --mode auto --device auto --mirror

# å¼ºåˆ¶ç”¨ GPUï¼ˆéœ€ onnxruntime-gpu + NVIDIA CUDA ç¯å¢ƒå¯ç”¨ï¼‰
uv run python demo_webcam.py --camera 0 --mode balanced --device cuda --mirror --infer-scale 0.85 --infer-interval 1

# ä½é… CPU æµç•…å‚æ•°ï¼ˆä¼˜å…ˆä¸å¡ï¼‰
uv run python demo_webcam.py --camera 0 --mode lightweight --device cpu --infer-scale 0.60 --infer-interval 2 --det-frequency 10

# å¿«é€Ÿè‡ªæ£€ï¼ˆè·‘ 120 å¸§åè‡ªåŠ¨é€€å‡ºï¼‰
uv run python demo_webcam.py --camera 0 --mode auto --max-frames 120

# æŸ¥çœ‹ ONNX Runtime providerï¼ˆæ’æŸ¥ GPUï¼‰
uv run python -c "import onnxruntime as ort; print(ort.get_available_providers())"

# è‡ªå®šä¹‰å½•åˆ¶è¾“å‡ºç›®å½•
uv run python demo_webcam.py --camera 0 --mode auto --record-dir outputs/records
```

æŒ‰é”®è¯´æ˜ï¼š
- `q` æˆ– `ESC`ï¼šé€€å‡º
- `r`ï¼šé‡ç½®é˜¶æ®µå’Œè½¨è¿¹çŠ¶æ€
- `h`ï¼šæ˜¾ç¤º/éšè— HUD ä¿¡æ¯é¢æ¿
- `v`ï¼šå¼€å§‹/åœæ­¢å½•åˆ¶è§†é¢‘ï¼ˆä¹Ÿå¯ç‚¹å‡»å·¦ä¸‹è§’ `REC/STOP` æŒ‰é’®ï¼‰

ç•Œé¢è¯´æ˜ï¼š
- HUD ä¿¡æ¯å’Œæç¤ºå·²æ”¹ä¸ºä¸­æ–‡ï¼ˆé»˜è®¤å³ä¸Šè§’åŠé€æ˜ï¼‰
- å½“å…¥é•œä¸å®Œæ•´æˆ–å¸§ç‡åä½æ—¶ï¼Œä¼šæ˜¾ç¤ºä¸­æ–‡æé†’
- æ–°å¢ AI æ•™ç»ƒæç¤ºæ¡ï¼šæ ¹æ®å®æ—¶åŠ¨ä½œåœ¨ç”»é¢ä¸Šæ–¹å±…ä¸­æç¤ºï¼ˆå¦‚â€œæ‰‹éƒ¨éœ€è¦æ›´é«˜â€â€œå®Œç¾ï¼â€ï¼‰
- çª—å£æ”¾å¤§åç”»é¢ä¼šè‡ªåŠ¨é“ºæ»¡çª—å£ï¼Œé¿å…åªæ˜¾ç¤ºåœ¨å·¦ä¸Šè§’
- å·¦ä¸‹è§’æä¾›å½•åˆ¶æŒ‰é’®ï¼Œå½•åˆ¶æ–‡ä»¶é»˜è®¤ä¿å­˜åˆ° `recordings/`

æ€§èƒ½è¯´æ˜ï¼š
- é¦–æ¬¡è¿è¡Œä¼šä¸‹è½½æ¨¡å‹ï¼Œé€Ÿåº¦ä¼šæ˜æ˜¾æ…¢ï¼Œä¸‹è½½å®Œæˆåä¼šæ¢å¤æ­£å¸¸
- å¯åŠ¨æ—¥å¿—ä¼šæ‰“å° `Provider` åˆ—è¡¨ï¼ŒåŒ…å« `CUDAExecutionProvider` æ‰è¡¨ç¤ºå·²å¯ç”¨ GPU æ¨ç†
- è‹¥å‡ºç° `CUDAçŠ¶æ€: ä¸å¯ç”¨ï¼ˆç¼ºå°‘ cudnn64_9.dllï¼‰`ï¼Œè¯·å®‰è£… cuDNN 9 å¹¶æŠŠ DLL åŠ å…¥ç³»ç»Ÿ `PATH`
- ä½é…æœºå™¨ä¼˜å…ˆä½¿ç”¨ `--mode lightweight --infer-interval 2 --infer-scale 0.60`
- é»˜è®¤åˆ†è¾¨ç‡ä¸º `960x540`ï¼ˆæ›´æµç•…ï¼‰ï¼›éœ€è¦æ›´æ¸…æ™°å¯æ‰‹åŠ¨åŠ  `--width 1280 --height 720`

### åŸºç¡€ä½¿ç”¨

```python
import cv2
from rtmlib import PoseTracker, Body, draw_skeleton

# åˆå§‹åŒ–å§¿æ€è¿½è¸ªå™¨
pose_tracker = PoseTracker(
    Body,
    mode='performance',
    det_frequency=5,
    backend='onnxruntime',
    device='cuda'  # æˆ– 'cpu'
)

# å¤„ç†æŒ¥æ†è§†é¢‘
cap = cv2.VideoCapture('golf_swing.mp4')
while cap.isOpened():
    ret, frame = cap.read()
    if not ret:
        break

    keypoints, scores = pose_tracker(frame)
    frame = draw_skeleton(frame, keypoints, scores, kpt_thr=0.5)

    cv2.imshow('Golf Swing Analysis', frame)
    if cv2.waitKey(1) & 0xFF == ord('q'):
        break

cap.release()
cv2.destroyAllWindows()
```

### å…¨èº« 133 å…³é”®ç‚¹åˆ†æï¼ˆå«æ‰‹æŒ‡/æ¡æ†ï¼‰

```python
from rtmlib import Wholebody, draw_skeleton

wholebody = Wholebody(
    mode='performance',
    backend='onnxruntime',
    device='cuda'
)

keypoints, scores = wholebody(frame)
frame = draw_skeleton(frame, keypoints, scores, kpt_thr=0.5)
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
golf-swing-ai-coach/
â”œâ”€â”€ README.md                   # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ PLAN.md                     # é¡¹ç›®è®¡åˆ’ä¹¦ï¼ˆå®æ–½æ–¹æ¡ˆï¼‰
â”œâ”€â”€ requirements.txt            # Python ä¾èµ–
â”œâ”€â”€ pyproject.toml              # uv é¡¹ç›®é…ç½®
â”œâ”€â”€ uv.lock                     # uv é”æ–‡ä»¶
â”œâ”€â”€ demo_webcam.py              # Windows æ‘„åƒå¤´å®æ—¶ Demo
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ pose_analyzer.py        # å§¿æ€åˆ†æ + è§’åº¦è®¡ç®— + ç®€åŒ–é˜¶æ®µè¯†åˆ«
â”‚   â””â”€â”€ visualizer.py           # é«˜å°”å¤«é£æ ¼éª¨éª¼ä¸ HUD ç»˜åˆ¶
â””â”€â”€ .venv/                      # æœ¬åœ°è™šæ‹Ÿç¯å¢ƒï¼ˆè¿è¡Œåç”Ÿæˆï¼‰
```

## ğŸ”— å‚è€ƒèµ„æº

- [RTMPose è®ºæ–‡](https://arxiv.org/abs/2303.07399) â€” å®æ—¶å¤šäººå§¿æ€ä¼°è®¡
- [GolfDB è®ºæ–‡](https://arxiv.org/abs/1903.06528) â€” é«˜å°”å¤«æŒ¥æ†è§†é¢‘æ•°æ®åº“
- [Sapiens](https://github.com/facebookresearch/sapiens) â€” Meta äººä½“è§†è§‰åŸºç¡€æ¨¡å‹ (ECCV 2024)
- [ViTPose](https://github.com/ViTAE-Transformer/ViTPose) â€” Vision Transformer å§¿æ€ä¼°è®¡
- [rtmlib](https://github.com/Tau-J/rtmlib) â€” è¶…è½»é‡å§¿æ€ä¼°è®¡æ¨ç†åº“

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestã€‚
